<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>è¦çš®å„ªæƒ é é¢ - å·¦é è¦½å³ç·¨è¼¯</title>
<style>
body {margin:0; font-family:"Noto Sans TC",sans-serif; background:#f9f8f6; display:flex; height:100vh;}
.preview-container {flex:1; display:flex; justify-content:center; overflow:auto; padding:20px;}
.paper {
  background:#fffaf6;
  border-radius:24px;
  padding:24px 18px 40px;
  width:95%;
  max-width:440px;
  min-width:280px;
  box-shadow:0 8px 20px rgba(0,0,0,0.08);
  text-align:center;
  position:relative;
  margin:auto;
  box-sizing:border-box;
}
.title {font-size:18px; font-weight:600; margin-bottom:8px; color:#3a3d55;}
.subtitle {font-size:13px; color:#4b6c8c; margin-bottom:18px;}
.product-row {display:grid; grid-template-columns:repeat(3,1fr); gap:8px; margin-bottom:16px; text-align:center;}
.product {min-height:160px; background:#fff1f0; border-radius:14px; padding:8px; font-size:13px; border:2px dashed #f0c6c0; display:flex; flex-direction:column; justify-content:space-between;}
.product a {color:#3a3d55; text-decoration:none; font-weight:500;}
.product a:hover {text-decoration:underline;}
.product img {margin-top:6px; width:100%; border-radius:10px; border:1px dashed #f0c6c0; background:#fff;}
.copy-tip {font-size:13px; color:#ff6f61; font-weight:700; margin-bottom:8px;}
.item {background:#fff1f0; border-radius:16px; padding:14px; margin-bottom:14px; text-align:center; border:2px dashed #f0c6c0; position:relative;}
button {
  width:100%;
  border:none;
  border-radius:16px;
  padding:12px 0;
  font-size:14px;
  color:#fff;
  cursor:pointer;
  font-weight:600;
  background:linear-gradient(135deg,#ff9ccf,#4b6c8c);
  box-shadow:6px 6px 0 #f0c6c0, -3px -3px 0 #f0c6c0;
  position:relative;
  transition: transform 0.15s, box-shadow 0.15s;
}
button:hover {transform:translateY(-2px); box-shadow:4px 4px 0 #f0c6c0, -2px -2px 0 #f0c6c0;}
button::after {content:"âœ‚"; position:absolute; top:-6px; right:-6px; font-size:10px; color:#ff6f61;}
.copied {position:absolute; top:8px; right:12px; font-size:12px; color:#27ae60; display:none; font-weight:600;}
.footer {margin-top:18px; font-size:13px; color:#3a3d55; line-height:1.5; text-align:left;}
.footer b {color:#ff6f61; font-weight:700;}
.bottom-logo {display:flex; align-items:center; justify-content:center; gap:10px; margin-top:24px; padding-top:12px; border-top:1px solid #555555; color:#555555; font-size:14px; font-weight:500;}
.bottom-logo img {width:36px; height:36px; border-radius:50%;}

/* ç·¨è¼¯é¢æ¿ */
.edit-panel {width:300px; max-height:100vh; overflow:auto; background:#fff; border-left:1px solid #ccc; padding:10px; box-sizing:border-box;}
.edit-panel h3 {margin:6px 0;}
.edit-panel label {font-size:12px; font-weight:600;}
.edit-panel input, .edit-panel textarea {width:100%; margin-bottom:6px; border-radius:6px; border:1px solid #ccc; padding:4px 6px;}
textarea {resize:vertical;}
#generated-code {height:200px;}

/* éŸ¿æ‡‰å¼ */
@media (max-width: 480px) {.product-row {grid-template-columns:repeat(2,1fr);}}
@media (max-width: 360px) {.product-row {grid-template-columns:1fr;}}
</style>
</head>
<body>

<div class="preview-container">
<div class="paper" id="preview">
  <div class="title" id="title"></div>
  <div class="subtitle" id="subtitle"></div>
  <div class="copy-tip" id="copy-tip"></div>
  <div class="product-row" id="product-row"></div>
  <div id="coupon-container"></div>
  <div class="footer" id="footer"></div>
  <div class="bottom-logo">
    <img id="logo" src="" alt="logo">
    <span id="threads-id"></span>
  </div>
</div>
</div>

<div class="edit-panel">
<h3>ç·¨è¼¯å…§å®¹</h3>
<label>æ¨™é¡Œ</label><input type="text" id="edit-title">
<label>å­æ¨™é¡Œ</label><input type="text" id="edit-subtitle">
<label>æç¤ºæ–‡å­—</label><input type="text" id="edit-copyTip">
<label>æ´»å‹•èªªæ˜</label><textarea id="edit-footer" rows="4"></textarea>
<label>Logo URL</label><input type="text" id="edit-logo">
<label>Threads ID</label><input type="text" id="edit-threads">
<h3>å•†å“ (åç¨±,é€£çµ,åœ–ç‰‡URLï¼Œæ¯è¡Œä¸€å€‹)</h3><textarea id="edit-products" rows="6"></textarea>
<h3>æŠ˜æ‰£ç¢¼ (æ–‡å­—,ä»£ç¢¼ï¼Œæ¯è¡Œä¸€å€‹)</h3><textarea id="edit-coupons" rows="4"></textarea>
<label>è·³è½‰ç¶²å€</label><input type="text" id="edit-redirect">
<button onclick="updateContent()">æ›´æ–°é è¦½</button>
<button onclick="generateCode()">ç”Ÿæˆé è¦½ HTML</button>
<textarea id="generated-code" readonly></textarea>
</div>

<script>
let data={
  title:"(æ•¸é‡æœ‰é™å…ˆç”¨å…ˆè´)",
  subtitle:"â—â—æ¨è–¦è²·è¦çš®ç›´ç‡Ÿå•†å“ï¼Œä¸€ä»¶å°±å…é‹ï¼ˆé»â¬‡ï¸ï¼‰â—â—",
  products:[
    {name:"ä¸‰å±¤è¡›ç”Ÿç´™", url:"https://s.shopee.tw/BN6sWCx96", img:"https://ppt.cc/farXdx@.jpg"},
    {name:"ç¾©ç¾å°æ³¡èŠ™", url:"https://s.shopee.tw/4AtFdpbR11", img:"https://ppt.cc/fwNqbx@.jpg"},
    {name:"å·§å…‹åŠ›é…¥ç‰‡", url:"https://s.shopee.tw/4VW62RDgaP", img:"https://ppt.cc/fNB7Zx@.jpg"}
  ],
  copyTip:"âš ï¸ è·³è½‰å¾Œè«‹é»é¸å·¦ä¸Šè§’ã€Œè¼¸å…¥å„ªæƒ ä»£ç¢¼ã€ å°‡æŠ˜æ‰£ç¢¼è²¼ä¸Š",
  coupons:[
    {text:"è¤‡è£½æ»¿ 100 æŠ˜ 20 æŠ˜æ‰£ç¢¼", code:"68J4ZP8TAAS"},
    {text:"è¤‡è£½æ»¿ 59 æŠ˜ 10 æŠ˜æ‰£ç¢¼", code:"45V35RQ4W"}
  ],
  footer:"ğŸ“… 12/27-12/31 é€£çºŒäº”å¤©å„æœ‰ä¸€å¼µè¦çš®åº—åˆ°åº— $99 å…é‹åŠµï¼ˆå·²æ­¸æˆ¶çµå¸³é¸ç”¨å³å¯ï¼‰<br>ğŸ‰ 12/31 å‘¨ä¸‰å…é‹æ—¥<br>â€¢ 01:00 å‰ï¼šéš”æ—¥åˆ°è²¨ $99 å…é‹<br>â€¢ 01:00 å¾Œï¼šéš”æ—¥åˆ°è²¨ $299 å…é‹<br>â€¢ 02:00 å‰ï¼šè¦çš®åº—åˆ°åº— / OK è¶…å•† $99 å…é‹<br>â€¢ 02:00 å¾Œï¼šè¦çš®åº—åˆ°åº— / OK è¶…å•† $149 å…é‹",
  logo:"https://ppt.cc/fcZ4px@.jpg",
  threadsId:"Threadsï½œ@ashley345a",
  redirectUrl:"https://s.shopee.tw/7fSOtpJWFd"
};

function renderPreview(){
  document.getElementById("title").innerHTML=data.title;
  document.getElementById("subtitle").innerHTML=data.subtitle;
  document.getElementById("copy-tip").innerHTML=data.copyTip;
  document.getElementById("footer").innerHTML=data.footer;
  document.getElementById("logo").src=data.logo;
  document.getElementById("threads-id").innerHTML=data.threadsId;

  const productRow=document.getElementById("product-row");
  productRow.innerHTML="";
  data.products.forEach(p=>{
    const div=document.createElement("div");
    div.className="product";
    div.innerHTML=`<a href="${p.url}" target="_blank">${p.name}<br><img src="${p.img}" alt="${p.name}"></a>`;
    productRow.appendChild(div);
  });

  const couponContainer=document.getElementById("coupon-container");
  couponContainer.innerHTML="";
  data.coupons.forEach(c=>{
    const div=document.createElement("div");
    div.className="item";
    div.innerHTML=`<button onclick="copyAndGo(this,'${c.code}')">${c.text}</button><div class="copied">å·²è¤‡è£½ âœ“</div>`;
    couponContainer.appendChild(div);
  });

  // ç·¨è¼¯é¢æ¿åŒæ­¥
  document.getElementById("edit-title").value=data.title;
  document.getElementById("edit-subtitle").value=data.subtitle;
  document.getElementById("edit-copyTip").value=data.copyTip;
  document.getElementById("edit-footer").value=data.footer;
  document.getElementById("edit-logo").value=data.logo;
  document.getElementById("edit-threads").value=data.threadsId;
  document.getElementById("edit-redirect").value=data.redirectUrl;
  document.getElementById("edit-products").value=data.products.map(p=>`${p.name},${p.url},${p.img}`).join("\n");
  document.getElementById("edit-coupons").value=data.coupons.map(c=>`${c.text},${c.code}`).join("\n");
}

// è¤‡è£½ + è·³è½‰
function copyAndGo(btn, code){
  navigator.clipboard.writeText(code).then(()=>{
    const tip=btn.nextElementSibling;
    tip.style.display="block";
    setTimeout(()=>tip.style.display="none",1500);
    setTimeout(()=>{window.location.href=data.redirectUrl},500);
  }).catch(()=>alert("è«‹é•·æŒ‰æ‰‹å‹•è¤‡è£½"));
}

// æ›´æ–°å…§å®¹ + è‡ªå‹•ä¿å­˜
function updateContent(){
  data.title=document.getElementById("edit-title").value;
  data.subtitle=document.getElementById("edit-subtitle").value;
  data.copyTip=document.getElementById("edit-copyTip").value;
  data.footer=document.getElementById("edit-footer").value;
  data.logo=document.getElementById("edit-logo").value;
  data.threadsId=document.getElementById("edit-threads").value;
  data.redirectUrl=document.getElementById("edit-redirect").value;

  const prodText=document.getElementById("edit-products").value.split("\n").filter(l=>l.trim());
  data.products=prodText.map(l=>{const [name,url,img]=l.split(",");return {name,url,img};});

  const couponText=document.getElementById("edit-coupons").value.split("\n").filter(l=>l.trim());
  data.coupons=couponText.map(l=>{const [text,code]=l.split(",");return {text,code};});

  renderPreview();
  localStorage.setItem("copyPageData", JSON.stringify(data)); // è‡ªå‹•ä¿å­˜
}

// ç”Ÿæˆé è¦½ HTML
function generateCode(){
  const previewHTML=document
